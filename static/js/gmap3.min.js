/*!
 *  GMAP3 Plugin for jQuery
 *  Version  : 7.2
 *  Date     : 2016/12/03
 *  Author   : DEMONTE Jean-Baptiste
 *  Contact  : jbdemonte@gmail.com
 *  Web site : http://gmap3.net
 *  Licence  : GPL-3.0+
 */
!function(n,t,e){"use strict";var o,r,i,u,a,c,s={},f=n.when,p=n.extend,l=n.isArray,g=n.isFunction,d=n.Deferred;function h(n){return p(!0,{},n||{})}function v(){var n=Array.prototype.slice,t=n.call(arguments,1);return n.apply(arguments[0],t)}function y(n){return void 0===n}function m(n){return f().then(function(){return n})}function L(n){return s[n]||(s[n]=w(n)),s[n]}function w(n){var t=o[n];function e(n){return t.apply(this,n)}return e.prototype=t.prototype,new e(v(arguments,1))}function x(n,t){P(n.split(" "),t)}function P(n,t){(l(n)?n:[n]).forEach(t)}function b(n){return Object.keys(n)}function M(n){return b(n).map(function(t){return n[t]})}function B(n,t){return(n=h(n)).bounds&&(n.bounds=k(n.bounds)),m(t(n))}function C(n,t,e){var r=d();return n=h(n),f().then(function(){var e,r,i=n.address;if(i)return delete n.address,(e=i,r=d(),"string"==typeof e&&(e={address:e}),L("Geocoder").geocode(e,function(n,t){t===o.GeocoderStatus.OK?r.resolve(n[0].geometry.location):r.reject(t)}),r).then(function(e){n[t]=e});n[t]=T(n[t])}).then(function(){r.resolve(e(n))}).fail(function(n){r.reject(n)}),r}function T(n,t){return l(n)?new o.LatLng(n[0],n[1]):!t||!n||n instanceof o.LatLng?n:new o.LatLng(n.lat,n.lng)}function k(n,t){return l(n)?new o.LatLngBounds({lat:n[2],lng:n[3]},{lat:n[0],lng:n[1]}):t&&!n.getCenter?new o.LatLngBounds({lat:n.south,lng:n.west},{lat:n.north,lng:n.east}):n}function E(t,r){var i=o.OverlayView,u=n(e.createElement("div")).css({border:"none",borderWidth:0,position:"absolute"}).append(r.content);function a(){var n=this,e=[];function a(t){return n.getProjection().fromLatLngToDivPixel(t)}i.call(n),n.setMap(t),n.onAdd=function(){n.getPanes().overlayMouseTarget.appendChild(u[0])},r.position?(n.getPosition=function(){return r.position},n.setPosition=function(t){r.position=t,n.draw()},n.draw=function(){var n=a(r.position);u.css({left:n.x+r.x+"px",top:n.y+r.y+"px"})}):(n.getBounds=function(){return r.bounds},n.setBounds=function(t){r.bounds=t,n.draw()},n.draw=function(){var n=a(r.bounds.getSouthWest()),t=a(r.bounds.getNorthEast());u.css({left:n.x+r.x+"px",top:t.y+r.y+"px",width:t.x-n.x+r.x+"px",height:n.y-t.y+r.y+"px"})}),n.onRemove=function(){e.map(function(n){o.event.removeListener(n)}),u.remove(),n.$=u=null},n.$=u}return(r=p({x:0,y:0},r)).position?r.position=T(r.position,!0):r.bounds&&(r.bounds=k(r.bounds,!0)),a.prototype=new i,new a}function j(n,t,e,o){this.cluster=n,this.markers=t,this.$=e.$,this.overlay=e,e.getBounds=function(){return w("LatLngBounds",o.getSouthWest(),o.getNorthEast())}}function D(n,t){var e,r,i,u,a,c=this,s=[],f=(t.size||200)>>1,p=!0,l={},g=[];function d(){var t,e,o,r,i,u,a,c,s,f;return w("Circle",{center:n.getCenter(),radius:1.15*(t=n.getCenter(),e=n.getBounds().getNorthEast(),o=Math,r=o.PI,i=r*t.lat()/180,u=r*t.lng()/180,a=r*e.lat()/180,c=r*e.lng()/180,s=o.cos,f=o.sin,6371e3*o.acos(o.min(s(i)*s(a)*s(u)*s(c)+s(i)*f(u)*s(a)*f(c)+f(i)*f(a),1)))}).getBounds()}function y(){var e,o,r,y,m,L,x=n.getZoom(),M={},B=[],C={};L=""+x,x>3&&(o=d(),P(s,function(n,t){o.contains(n.getPosition())||(L+="-"+t,C[t]=!0,n.getMap()&&n.setMap(null))})),a&&P(s,function(n,t){C[t]||a(n)||(L+="-"+t,C[t]=!0,n.getMap()&&n.setMap(null))}),L!==i&&(i=L,P(s,function(i,a){var g,d;C[a]||(e=[a],g=i.getPosition(),d=u.fromLatLngToDivPixel(g),o=w("LatLngBounds",u.fromDivPixelToLatLng(w("Point",d.x-f,d.y+f)),u.fromDivPixelToLatLng(w("Point",d.x+f,d.y-f))),p&&P(v(s,a+1),function(n,t){!C[t+=a+1]&&o.contains(n.getPosition())&&(e.push(t),C[t]=!0)}),y=e.join("-"),M[y]=!0,l[y]||(m=e.map(function(n){return s[n]}),(r=t.cb(v(m)))?(o=w("LatLngBounds"),P(m,function(n){o.extend(n.getPosition()),n.getMap()&&n.setMap(null)}),(r=h(r)).position=o.getCenter(),l[y]=new j(c,v(m),E(n,r),o),B.push(l[y])):P(m,function(t){t.getMap()||t.setMap(n)})))}),P(b(l),function(n){M[n]||(l[n].overlay.setMap(null),delete l[n])}),B.length&&P(g,function(n){n(B)}))}function m(){clearTimeout(e),e=setTimeout(y,100)}(t=t||{}).markers=t.markers||[],c._b=function(n){n(M(l)),g.push(n)},c.markers=function(){return v(s)},c.groups=function(){return M(l)},c.enable=function(){p||(p=!0,i="",m())},c.disable=function(){p&&(p=!1,i="",m())},c.add=function(n){s.push(n),i="",m()},c.remove=function(n){s=s.filter(function(t){return t!==n}),i="",m()},c.filter=function(n){a!==n&&(a=n,i="",m())},t.markers.map(function(n){n.position=T(n.position),s.push(w("Marker",n))}),r=setInterval(function(){(u=function(n){function t(){return this.onAdd=this.onRemove=this.draw=function(){},o.OverlayView.call(this)}t.prototype=new o.OverlayView;var e=new t;return e.setMap(n),e.getProjection()}(n))&&(clearInterval(r),o.event.addListener(n,"zoom_changed",m),o.event.addListener(n,"bounds_changed",m),y())},10)}f((a=d(),c="__gmap3",n.holdReady(!0),u=function(){var o;t.google&&t.google.maps||!1===r?a.resolve():(t[c]=function(){delete t[c],a.resolve()},(i=e.createElement("script")).type="text/javascript",i.src="https://maps.googleapis.com/maps/api/js?callback="+c+(r?"&"+("string"==typeof r?r:b(o=r).map(function(n){return encodeURIComponent(n)+"="+encodeURIComponent(o[n])}).join("&")):""),n("head").append(i))},"loading"!=e.readyState?u():e.addEventListener("DOMContentLoaded",u),a)).then(function(){n.holdReady(!1)}),n.gmap3=function(n){r=n},n.fn.gmap3=function(e){var r=[];return o=t.google.maps,this.each(function(){var t=n(this),i=t.data("gmap3");i||(i=new function(t,e){var r,i=[],u=f(),a=this;function c(){return{$:t,get:a.get}}function s(t,e,r,i){var u=arguments.length>3;u||(i=r),n.each(t,function(n,t){P(e,function(e){var a=e instanceof j,s=a||e instanceof o.OverlayView,f=s?e.$.get(0):e;o.event["add"+(s?"Dom":"")+"Listener"+(i?"Once":"")](f,n,function(n){P(t,function(t){if(g(t))if(a)t.call(c(),void 0,e,e.cluster,n);else if(u){var o=v(r);o.unshift(e),o.push(n),t.apply(c(),o)}else t.call(c(),e,n)})})})})}function p(t){return function(e){if(l(e)){var o=[],r=e.map(function(n){return t.call(a,n).then(function(n){o.push(n)})});return(u=r,f.apply(n,u)).then(function(){return i.push(o),o})}return t.apply(a,arguments).then(function(n){return i.push(n),n});var u}}function b(n){return function(){var t=v(arguments);return u=u.then(function(e){return g(t[0])?f(t[0].call(c(),e)).then(function(e){return t[0]=e,n.apply(a,t)}):f(n.apply(a,t))})}}a.map=b(function(n){return r||C(n,"center",function(n){return r=w("Map",t.get(0),n),i.push(r),r})}),x("Marker:position Circle:center InfoWindow:position:0 Polyline:path Polygon:paths",function(n){var t=(n=n.split(":"))[1]||"";a[n[0].toLowerCase()]=b(p(function(e){return(t.match(/^path/)?function(n,t,e){return(n=h(n))[t]=(n[t]||[]).map(T),m(e(n))}:C)(e,t,function(t){return"0"!==n[2]&&(t.map=r),w(n[0],t)})}))}),x("TrafficLayer TransitLayer BicyclingLayer",function(n){a[n.toLowerCase()]=b(function(){var t=w(n);return i.push(t),t.setMap(r),t})}),a.kmllayer=b(p(function(n){return(n=h(n)).map=r,f(w("KmlLayer",n))})),a.rectangle=b(p(function(n){return B(n,function(n){return n.map=r,w("Rectangle",n)})})),a.overlay=b(p(function(n){function t(n){return E(r,n)}return(n=h(n)).bounds?B(n,t):C(n,"position",t)})),a.groundoverlay=b(function(n,t,e){return B({bounds:t},function(t){(e=h(e)).map=r;var o=w("GroundOverlay",n,t.bounds,e);return i.push(o),o})}),a.styledmaptype=b(function(n,t,e){var o=w("StyledMapType",t,e);return i.push(o),r.mapTypes.set(n,o),o}),a.streetviewpanorama=b(function(t,e){return C(e,"position",function(e){var o=w("StreetViewPanorama",n(t).get(0),e);return r.setStreetView(o),i.push(o),o})}),a.route=b(function(n){var t=d();return(n=h(n)).origin=T(n.origin),n.destination=T(n.destination),L("DirectionsService").route(n,function(n,e){i.push(n),t.resolve(e===o.DirectionsStatus.OK&&n)}),t}),a.cluster=b(function(n){var t=new D(r,h(n));return i.push(t),m(t)}),a.directionsrenderer=b(function(t){var e;return t&&((t=h(t)).map=r,t.panel&&(t.panel=n(t.panel).get(0)),e=w("DirectionsRenderer",t)),i.push(e),e}),a.latlng=b(p(function(n){return C(n,"latlng",function(n){return i.push(n.latlng),n.latlng})})),a.fit=b(function(){var n=w("LatLngBounds");return P(i,function(t){t!==r&&P(t,function(t){t&&(t.getPosition&&t.getPosition()?n.extend(t.getPosition()):t.getBounds&&t.getBounds()?(n.extend(t.getBounds().getNorthEast()),n.extend(t.getBounds().getSouthWest())):t.getPaths&&t.getPaths()?P(t.getPaths().getArray(),function(t){P(t.getArray(),function(t){n.extend(t)})}):t.getPath&&t.getPath()?P(t.getPath().getArray(),function(t){n.extend(t)}):t.getCenter&&t.getCenter()&&n.extend(t.getCenter()))})}),n.isEmpty()||r.fitBounds(n),!0}),a.wait=function(n){u=u.then(function(t){var e=d();return setTimeout(function(){e.resolve(t)},n),e})},a.then=function(n){g(n)&&(u=u.then(function(t){return f(n.call(c(),t)).then(function(n){return y(n)?t:n})}))},a.catch=function(n){g(n)&&(u=u.then(null,function(t){return f(n.call(c(),t))}))},x("on once",function(n,t){a[n]=function(){var n=arguments[0];n&&("string"==typeof n&&((n={})[arguments[0]]=v(arguments,1)),u.then(function(e){if(e){if(e instanceof D)return e._b(function(e){e&&e.length&&s(n,e,t)}),s(n,e.markers(),[void 0,e],t);s(n,e,t)}}))}}),a.get=function(n){return y(n)?i.map(function(n){return l(n)?n.slice():n}):(n<0&&(n=i.length+n),l(i[n])?i[n].slice():i[n])},e&&a.map(e)}(t,e),t.data("gmap3",i)),r.push(i)}),new function(n,t){var e=this;b(t[0]).forEach(function(n){e[n]=function(){var o=[],r=v(arguments);return t.forEach(function(t){o.push(t[n].apply(t,r))}),"get"===n?o.length>1?o:o[0]:e}}),e.$=n}(this,r)}}(jQuery,window,document);